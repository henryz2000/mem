{"ast":null,"code":"import { visit as e } from \"unist-util-visit\";\nimport { toString as r } from \"hast-util-to-string\";\nimport { filter as t } from \"unist-util-filter\";\nimport n from \"parse-numeric-range\";\nimport { refractor as i } from \"refractor/lib/common.js\";\nimport { refractor as o } from \"refractor/lib/all.js\";\n\nfunction l() {\n  l = function l(e, r) {\n    return new t(e, void 0, r);\n  };\n\n  var e = RegExp.prototype,\n      r = new WeakMap();\n\n  function t(e, n, i) {\n    var o = new RegExp(e, n);\n    return r.set(o, i || r.get(e)), a(o, t.prototype);\n  }\n\n  function n(e, t) {\n    var n = r.get(t);\n    return Object.keys(n).reduce(function (r, t) {\n      return r[t] = e[n[t]], r;\n    }, Object.create(null));\n  }\n\n  return s(t, RegExp), t.prototype.exec = function (r) {\n    var t = e.exec.call(this, r);\n    return t && (t.groups = n(t, this)), t;\n  }, t.prototype[Symbol.replace] = function (t, i) {\n    if (\"string\" == typeof i) {\n      var o = r.get(this);\n      return e[Symbol.replace].call(this, t, i.replace(/\\$<([^>]+)>/g, function (e, r) {\n        return \"$\" + o[r];\n      }));\n    }\n\n    if (\"function\" == typeof i) {\n      var l = this;\n      return e[Symbol.replace].call(this, t, function () {\n        var e = arguments;\n        return \"object\" != typeof e[e.length - 1] && (e = [].slice.call(e)).push(n(e, l)), i.apply(this, e);\n      });\n    }\n\n    return e[Symbol.replace].call(this, t, i);\n  }, l.apply(this, arguments);\n}\n\nfunction s(e, r) {\n  if (\"function\" != typeof r && null !== r) throw new TypeError(\"Super expression must either be null or a function\");\n  e.prototype = Object.create(r && r.prototype, {\n    constructor: {\n      value: e,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), r && a(e, r);\n}\n\nfunction a(e, r) {\n  return a = Object.setPrototypeOf || function (e, r) {\n    return e.__proto__ = r, e;\n  }, a(e, r);\n}\n\nfunction u(e, r) {\n  (null == r || r > e.length) && (r = e.length);\n\n  for (var t = 0, n = new Array(r); t < r; t++) {\n    n[t] = e[t];\n  }\n\n  return n;\n}\n\nfunction c(e, r) {\n  var t = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n  if (t) return (t = t.call(e)).next.bind(t);\n\n  if (Array.isArray(e) || (t = function (e, r) {\n    if (e) {\n      if (\"string\" == typeof e) return u(e, r);\n      var t = Object.prototype.toString.call(e).slice(8, -1);\n      return \"Object\" === t && e.constructor && (t = e.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(e) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? u(e, r) : void 0;\n    }\n  }(e)) || r && e && \"number\" == typeof e.length) {\n    t && (e = t);\n    var n = 0;\n    return function () {\n      return n >= e.length ? {\n        done: !0\n      } : {\n        done: !1,\n        value: e[n++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar p = function p(i) {\n  return function (o) {\n    return void 0 === o && (o = {}), function (r) {\n      e(r, \"element\", s);\n    };\n\n    function s(e, s, a) {\n      var u, p;\n\n      if (a && \"pre\" === a.tagName && \"code\" === e.tagName) {\n        var f = (null == e || null == (u = e.data) ? void 0 : u.meta) || (null == e || null == (p = e.properties) ? void 0 : p.metastring) || \"\";\n        e.properties.className ? \"boolean\" == typeof e.properties.className ? e.properties.className = [] : Array.isArray(e.properties.className) || (e.properties.className = [e.properties.className]) : e.properties.className = [], e.properties.className.push(\"code-highlight\");\n\n        var m,\n            h,\n            d = function (e) {\n          for (var r, t = c(e.properties.className); !(r = t()).done;) {\n            var n = r.value;\n            if (\"language-\" === n.slice(0, 9)) return n.slice(9).toLowerCase();\n          }\n\n          return null;\n        }(e);\n\n        if (d) try {\n          var g;\n          g = null != d && d.includes(\"diff-\") ? d.split(\"-\")[1] : d, m = i.highlight(r(e), g), a.properties.className = (a.properties.className || []).concat(\"language-\" + g);\n        } catch (r) {\n          if (!o.ignoreMissing || !/Unknown language/.test(r.message)) throw r;\n          m = e;\n        } else m = e;\n        m.children = (h = 1, function e(r) {\n          return r.reduce(function (r, t) {\n            if (\"text\" === t.type) {\n              var n = t.value,\n                  i = (n.match(/\\n/g) || \"\").length;\n              if (0 === i) t.position = {\n                start: {\n                  line: h,\n                  column: 1\n                },\n                end: {\n                  line: h,\n                  column: 1\n                }\n              }, r.push(t);else for (var o, l = n.split(\"\\n\"), s = c(l.entries()); !(o = s()).done;) {\n                var a = o.value,\n                    u = a[0],\n                    p = a[1];\n                r.push({\n                  type: \"text\",\n                  value: u === l.length - 1 ? p : p + \"\\n\",\n                  position: {\n                    start: {\n                      line: h + u,\n                      column: 1\n                    },\n                    end: {\n                      line: h + u,\n                      column: 1\n                    }\n                  }\n                });\n              }\n              return h += i, r;\n            }\n\n            if (Object.prototype.hasOwnProperty.call(t, \"children\")) {\n              var f = h;\n              return t.children = e(t.children), r.push(t), t.position = {\n                start: {\n                  line: f,\n                  column: 1\n                },\n                end: {\n                  line: h,\n                  column: 1\n                }\n              }, r;\n            }\n\n            return r.push(t), r;\n          }, []);\n        })(m.children), m.position = m.children.length > 0 ? {\n          start: {\n            line: m.children[0].position.start.line,\n            column: 0\n          },\n          end: {\n            line: m.children[m.children.length - 1].position.end.line,\n            column: 0\n          }\n        } : {\n          start: {\n            line: 0,\n            column: 0\n          },\n          end: {\n            line: 0,\n            column: 0\n          }\n        };\n\n        for (var v, y = function (e) {\n          var r = /{([\\d,-]+)}/,\n              t = e.split(\",\").map(function (e) {\n            return e.trim();\n          }).join();\n\n          if (r.test(t)) {\n            var i = r.exec(t)[1],\n                o = n(i);\n            return function (e) {\n              return o.includes(e + 1);\n            };\n          }\n\n          return function () {\n            return !1;\n          };\n        }(f), b = function (e) {\n          var r = /*#__PURE__*/l(/showLineNumbers=([0-9]+)/i, {\n            lines: 1\n          });\n\n          if (r.test(e)) {\n            var t = r.exec(e);\n            return Number(t.groups.lines);\n          }\n\n          return 1;\n        }(f), w = function (e) {\n          for (var r = new Array(e), t = 0; t < e; t++) {\n            r[t] = {\n              type: \"element\",\n              tagName: \"span\",\n              properties: {\n                className: []\n              },\n              children: []\n            };\n          }\n\n          return r;\n        }(m.position.end.line), N = [\"showlinenumbers=false\", 'showlinenumbers=\"false\"', \"showlinenumbers={false}\"], j = function j() {\n          var e = v.value,\n              n = e[0],\n              i = e[1];\n          i.properties.className = [\"code-line\"];\n          var l = t(m, function (e) {\n            return e.position.start.line <= n + 1 && e.position.end.line >= n + 1;\n          });\n          i.children = l.children, !f.toLowerCase().includes(\"showLineNumbers\".toLowerCase()) && !o.showLineNumbers || N.some(function (e) {\n            return f.toLowerCase().includes(e);\n          }) || (i.properties.line = [(n + b).toString()], i.properties.className.push(\"line-number\")), y(n) && i.properties.className.push(\"highlight-line\"), (\"diff\" === d || null != d && d.includes(\"diff-\")) && \"-\" === r(i).substring(0, 1) ? i.properties.className.push(\"deleted\") : (\"diff\" === d || null != d && d.includes(\"diff-\")) && \"+\" === r(i).substring(0, 1) && i.properties.className.push(\"inserted\");\n        }, x = c(w.entries()); !(v = x()).done;) {\n          j();\n        }\n\n        w.length > 0 && \"\" === r(w[w.length - 1]).trim() && w.pop(), e.children = w;\n      }\n    }\n  };\n},\n    f = p(i),\n    m = p(o);\n\nexport { m as default, f as rehypePrismCommon, p as rehypePrismGenerator };","map":{"version":3,"sources":["../src/generator.js","../src/common.js","../src/all.js"],"names":["node","properties","className","classListItem","slice","toLowerCase","meta","RE","parsedMeta","split","map","str","trim","join","test","strlineNumbers","exec","lineNumbers","rangeParser","index","includes","groups","lines","Number","number","a","Array","i","type","tagName","children","startLineNum","addNodePosition","ast","reduce","result","value","numLines","match","length","position","start","line","column","end","push","entries","Object","prototype","hasOwnProperty","call","initialLineNum","rehypePrismGenerator","refractor","options","tree","visit","visitor","parent","data","metastring","isArray","lang","getLanguage","refractorRoot","rootLang","highlight","toString","concat","err","ignoreMissing","message","shouldHighlightLine","calculateLinesToHighlight","startingLineNumber","calculateStartingLine","codeLineArray","createLineNodes","falseShowLineNumbersStr","treeExtract","filter","showLineNumbers","some","substring","pop","rehypePrismCommon","refractorCommon","rehypePrismAll","refractorAll"],"mappings":"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","sourcesContent":["/**\n * @typedef {import('hast').Element} Element\n * @typedef {import('hast').Root} Root\n * @typedef Options options\n *   Configuration.\n * @property {boolean} [showLineNumbers]\n *   Set `showLineNumbers` to `true` to always display line number\n * @property {boolean} [ignoreMissing]\n *   Set `ignoreMissing` to `true` to ignore unsupported languages and line highlighting when no language is specified\n */\n\nimport { visit } from 'unist-util-visit'\nimport { toString } from 'hast-util-to-string'\nimport { filter } from 'unist-util-filter'\nimport rangeParser from 'parse-numeric-range'\n\n/**\n * @param {Element} node\n * @return {string|null}\n */\nconst getLanguage = (node) => {\n  const className = node.properties.className\n  //@ts-ignore\n  for (const classListItem of className) {\n    if (classListItem.slice(0, 9) === 'language-') {\n      return classListItem.slice(9).toLowerCase()\n    }\n  }\n  return null\n}\n\n/**\n * Create a closure that determines if we have to highlight the given index\n *\n * @param {string} meta\n * @return { (index:number) => boolean }\n */\nconst calculateLinesToHighlight = (meta) => {\n  const RE = /{([\\d,-]+)}/\n  // Remove space between {} e.g. {1, 3}\n  const parsedMeta = meta\n    .split(',')\n    .map((str) => str.trim())\n    .join()\n  if (RE.test(parsedMeta)) {\n    const strlineNumbers = RE.exec(parsedMeta)[1]\n    const lineNumbers = rangeParser(strlineNumbers)\n    return (index) => lineNumbers.includes(index + 1)\n  } else {\n    return () => false\n  }\n}\n\n/**\n * Check if we want to start the line numbering from a given number or 1\n * showLineNumbers=5, will start the numbering from 5\n * @param {string} meta\n * @returns {number}\n */\nconst calculateStartingLine = (meta) => {\n  const RE = /showLineNumbers=(?<lines>\\d+)/i\n  // pick the line number after = using a named capturing group\n  if (RE.test(meta)) {\n    const {\n      groups: { lines },\n    } = RE.exec(meta)\n    return Number(lines)\n  }\n  return 1\n}\n\n/**\n * Create container AST for node lines\n *\n * @param {number} number\n * @return {Element[]}\n */\nconst createLineNodes = (number) => {\n  const a = new Array(number)\n  for (let i = 0; i < number; i++) {\n    a[i] = {\n      type: 'element',\n      tagName: 'span',\n      properties: { className: [] },\n      children: [],\n    }\n  }\n  return a\n}\n\n/**\n * Split multiline text nodes into individual nodes with positioning\n * Add a node start and end line position information for each text node\n *\n * @return { (ast:Element['children']) => Element['children'] }\n *\n */\nconst addNodePositionClosure = () => {\n  let startLineNum = 1\n  /**\n   * @param {Element['children']} ast\n   * @return {Element['children']}\n   */\n  const addNodePosition = (ast) => {\n    return ast.reduce((result, node) => {\n      if (node.type === 'text') {\n        const value = /** @type {string} */ (node.value)\n        const numLines = (value.match(/\\n/g) || '').length\n        if (numLines === 0) {\n          node.position = {\n            // column: 1 is needed to avoid error with @next/mdx\n            // https://github.com/timlrx/rehype-prism-plus/issues/44\n            start: { line: startLineNum, column: 1 },\n            end: { line: startLineNum, column: 1 },\n          }\n          result.push(node)\n        } else {\n          const lines = value.split('\\n')\n          for (const [i, line] of lines.entries()) {\n            result.push({\n              type: 'text',\n              value: i === lines.length - 1 ? line : line + '\\n',\n              position: {\n                start: { line: startLineNum + i, column: 1 },\n                end: { line: startLineNum + i, column: 1 },\n              },\n            })\n          }\n        }\n        startLineNum = startLineNum + numLines\n\n        return result\n      }\n\n      if (Object.prototype.hasOwnProperty.call(node, 'children')) {\n        const initialLineNum = startLineNum\n        // @ts-ignore\n        node.children = addNodePosition(node.children, startLineNum)\n        result.push(node)\n        node.position = {\n          start: { line: initialLineNum, column: 1 },\n          end: { line: startLineNum, column: 1 },\n        }\n        return result\n      }\n\n      result.push(node)\n      return result\n    }, [])\n  }\n  return addNodePosition\n}\n\n/**\n * Rehype prism plugin generator that highlights code blocks with refractor (prismjs)\n *\n * Pass in your own refractor object with the required languages registered:\n * https://github.com/wooorm/refractor#refractorregistersyntax\n *\n * @param {import('refractor/lib/core').Refractor} refractor\n * @return {import('unified').Plugin<[Options?], Root>}\n */\nconst rehypePrismGenerator = (refractor) => {\n  return (options = {}) => {\n    return (tree) => {\n      visit(tree, 'element', visitor)\n    }\n\n    /**\n     * @param {Element} node\n     * @param {number} index\n     * @param {Element} parent\n     */\n    function visitor(node, index, parent) {\n      if (!parent || parent.tagName !== 'pre' || node.tagName !== 'code') {\n        return\n      }\n\n      let meta = /** @type {string} */ (node?.data?.meta || node?.properties?.metastring || '')\n      // Coerce className to array\n      if (node.properties.className) {\n        if (typeof node.properties.className === 'boolean') {\n          node.properties.className = []\n        } else if (!Array.isArray(node.properties.className)) {\n          node.properties.className = [node.properties.className]\n        }\n      } else {\n        node.properties.className = []\n      }\n      node.properties.className.push('code-highlight')\n      const lang = getLanguage(node)\n\n      /** @type {Element} */\n      let refractorRoot\n\n      // Syntax highlight\n      if (lang) {\n        try {\n          let rootLang\n          if (lang?.includes('diff-')){\n            rootLang=lang.split('-')[1]\n          } else{\n            rootLang=lang\n          }\n          // @ts-ignore\n          refractorRoot = refractor.highlight(toString(node), rootLang)\n          // @ts-ignore className is already an array\n          parent.properties.className = (parent.properties.className || []).concat(\n            'language-' + rootLang\n          )\n        } catch (err) {\n          if (options.ignoreMissing && /Unknown language/.test(err.message)) {\n            refractorRoot = node\n          } else {\n            throw err\n          }\n        }\n      } else {\n        refractorRoot = node\n      }\n\n      refractorRoot.children = addNodePositionClosure()(refractorRoot.children)\n\n      // Add position info to root\n      if (refractorRoot.children.length > 0) {\n        refractorRoot.position = {\n          start: { line: refractorRoot.children[0].position.start.line, column: 0 },\n          end: {\n            line: refractorRoot.children[refractorRoot.children.length - 1].position.end.line,\n            column: 0,\n          },\n        }\n      } else {\n        refractorRoot.position = {\n          start: { line: 0, column: 0 },\n          end: { line: 0, column: 0 },\n        }\n      }\n\n      const shouldHighlightLine = calculateLinesToHighlight(meta)\n      const startingLineNumber = calculateStartingLine(meta)\n      const codeLineArray = createLineNodes(refractorRoot.position.end.line)\n\n      const falseShowLineNumbersStr = [\n        'showlinenumbers=false',\n        'showlinenumbers=\"false\"',\n        'showlinenumbers={false}',\n      ]\n      for (const [i, line] of codeLineArray.entries()) {\n        // Default class name for each line\n        line.properties.className = ['code-line']\n\n        // Syntax highlight\n        const treeExtract = filter(\n          refractorRoot,\n          (node) => node.position.start.line <= i + 1 && node.position.end.line >= i + 1\n        )\n        line.children = treeExtract.children\n\n        // Line number\n        if (\n          (meta.toLowerCase().includes('showLineNumbers'.toLowerCase()) ||\n            options.showLineNumbers) &&\n          !falseShowLineNumbersStr.some((str) => meta.toLowerCase().includes(str))\n        ) {\n          line.properties.line = [(i + startingLineNumber).toString()]\n          line.properties.className.push('line-number')\n        }\n\n        // Line highlight\n        if (shouldHighlightLine(i)) {\n          line.properties.className.push('highlight-line')\n        }\n\n        // Diff classes\n        if ((lang === 'diff' || lang?.includes('diff-')) && toString(line).substring(0, 1) === '-') {\n          line.properties.className.push('deleted')\n        } else if ((lang === 'diff' || lang?.includes('diff-')) && toString(line).substring(0, 1) === '+') {\n          line.properties.className.push('inserted')\n        }\n      }\n\n      // Remove possible trailing line when splitting by \\n which results in empty array\n      if (\n        codeLineArray.length > 0 &&\n        toString(codeLineArray[codeLineArray.length - 1]).trim() === ''\n      ) {\n        codeLineArray.pop()\n      }\n\n      node.children = codeLineArray\n    }\n  }\n}\n\nexport default rehypePrismGenerator\n","import { refractor as refractorCommon } from 'refractor/lib/common.js'\nimport rehypePrismGenerator from './generator.js'\n\n/**\n * Rehype prism plugin that highlights code blocks with refractor (prismjs)\n * Supported languages: https://github.com/wooorm/refractor#data\n *\n * Consider using rehypePrismGenerator to generate a plugin\n * that supports your required languages.\n */\nconst rehypePrismCommon = rehypePrismGenerator(refractorCommon)\n\nexport default rehypePrismCommon\n","import { refractor as refractorAll } from 'refractor/lib/all.js'\nimport rehypePrismGenerator from './generator.js'\n\n/**\n * Rehype prism plugin that highlights code blocks with refractor (prismjs)\n * This supports all the languages and should be used on the server side.\n *\n * Consider using rehypePrismCommon or rehypePrismGenerator to generate a plugin\n * that supports your required languages.\n */\nconst rehypePrismAll = rehypePrismGenerator(refractorAll)\n\nexport default rehypePrismAll\n"]},"metadata":{},"sourceType":"module"}