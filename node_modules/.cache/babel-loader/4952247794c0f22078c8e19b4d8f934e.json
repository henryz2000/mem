{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar utils_1 = require(\"./utils\");\n\nfunction parseCssSelector(str, pos, pseudos, attrEqualityMods, ruleNestingOperators, substitutesEnabled) {\n  var l = str.length;\n  var chr = '';\n\n  function getStr(quote, escapeTable) {\n    var result = '';\n    pos++;\n    chr = str.charAt(pos);\n\n    while (pos < l) {\n      if (chr === quote) {\n        pos++;\n        return result;\n      } else if (chr === '\\\\') {\n        pos++;\n        chr = str.charAt(pos);\n        var esc = void 0;\n\n        if (chr === quote) {\n          result += quote;\n        } else if ((esc = escapeTable[chr]) !== undefined) {\n          result += esc;\n        } else if (utils_1.isHex(chr)) {\n          var hex = chr;\n          pos++;\n          chr = str.charAt(pos);\n\n          while (utils_1.isHex(chr)) {\n            hex += chr;\n            pos++;\n            chr = str.charAt(pos);\n          }\n\n          if (chr === ' ') {\n            pos++;\n            chr = str.charAt(pos);\n          }\n\n          result += String.fromCharCode(parseInt(hex, 16));\n          continue;\n        } else {\n          result += chr;\n        }\n      } else {\n        result += chr;\n      }\n\n      pos++;\n      chr = str.charAt(pos);\n    }\n\n    return result;\n  }\n\n  function getIdent() {\n    var result = '';\n    chr = str.charAt(pos);\n\n    while (pos < l) {\n      if (utils_1.isIdent(chr)) {\n        result += chr;\n      } else if (chr === '\\\\') {\n        pos++;\n\n        if (pos >= l) {\n          throw Error('Expected symbol but end of file reached.');\n        }\n\n        chr = str.charAt(pos);\n\n        if (utils_1.identSpecialChars[chr]) {\n          result += chr;\n        } else if (utils_1.isHex(chr)) {\n          var hex = chr;\n          pos++;\n          chr = str.charAt(pos);\n\n          while (utils_1.isHex(chr)) {\n            hex += chr;\n            pos++;\n            chr = str.charAt(pos);\n          }\n\n          if (chr === ' ') {\n            pos++;\n            chr = str.charAt(pos);\n          }\n\n          result += String.fromCharCode(parseInt(hex, 16));\n          continue;\n        } else {\n          result += chr;\n        }\n      } else {\n        return result;\n      }\n\n      pos++;\n      chr = str.charAt(pos);\n    }\n\n    return result;\n  }\n\n  function skipWhitespace() {\n    chr = str.charAt(pos);\n    var result = false;\n\n    while (chr === ' ' || chr === \"\\t\" || chr === \"\\n\" || chr === \"\\r\" || chr === \"\\f\") {\n      result = true;\n      pos++;\n      chr = str.charAt(pos);\n    }\n\n    return result;\n  }\n\n  function parse() {\n    var res = parseSelector();\n\n    if (pos < l) {\n      throw Error('Rule expected but \"' + str.charAt(pos) + '\" found.');\n    }\n\n    return res;\n  }\n\n  function parseSelector() {\n    var selector = parseSingleSelector();\n\n    if (!selector) {\n      return null;\n    }\n\n    var res = selector;\n    chr = str.charAt(pos);\n\n    while (chr === ',') {\n      pos++;\n      skipWhitespace();\n\n      if (res.type !== 'selectors') {\n        res = {\n          type: 'selectors',\n          selectors: [selector]\n        };\n      }\n\n      selector = parseSingleSelector();\n\n      if (!selector) {\n        throw Error('Rule expected after \",\".');\n      }\n\n      res.selectors.push(selector);\n    }\n\n    return res;\n  }\n\n  function parseSingleSelector() {\n    skipWhitespace();\n    var selector = {\n      type: 'ruleSet'\n    };\n    var rule = parseRule();\n\n    if (!rule) {\n      return null;\n    }\n\n    var currentRule = selector;\n\n    while (rule) {\n      rule.type = 'rule';\n      currentRule.rule = rule;\n      currentRule = rule;\n      skipWhitespace();\n      chr = str.charAt(pos);\n\n      if (pos >= l || chr === ',' || chr === ')') {\n        break;\n      }\n\n      if (ruleNestingOperators[chr]) {\n        var op = chr;\n        pos++;\n        skipWhitespace();\n        rule = parseRule();\n\n        if (!rule) {\n          throw Error('Rule expected after \"' + op + '\".');\n        }\n\n        rule.nestingOperator = op;\n      } else {\n        rule = parseRule();\n\n        if (rule) {\n          rule.nestingOperator = null;\n        }\n      }\n    }\n\n    return selector;\n  } // @ts-ignore no-overlap\n\n\n  function parseRule() {\n    var rule = null;\n\n    while (pos < l) {\n      chr = str.charAt(pos);\n\n      if (chr === '*') {\n        pos++;\n        (rule = rule || {}).tagName = '*';\n      } else if (utils_1.isIdentStart(chr) || chr === '\\\\') {\n        (rule = rule || {}).tagName = getIdent();\n      } else if (chr === '.') {\n        pos++;\n        rule = rule || {};\n        (rule.classNames = rule.classNames || []).push(getIdent());\n      } else if (chr === '#') {\n        pos++;\n        (rule = rule || {}).id = getIdent();\n      } else if (chr === '[') {\n        pos++;\n        skipWhitespace();\n        var attr = {\n          name: getIdent()\n        };\n        skipWhitespace(); // @ts-ignore\n\n        if (chr === ']') {\n          pos++;\n        } else {\n          var operator = '';\n\n          if (attrEqualityMods[chr]) {\n            operator = chr;\n            pos++;\n            chr = str.charAt(pos);\n          }\n\n          if (pos >= l) {\n            throw Error('Expected \"=\" but end of file reached.');\n          }\n\n          if (chr !== '=') {\n            throw Error('Expected \"=\" but \"' + chr + '\" found.');\n          }\n\n          attr.operator = operator + '=';\n          pos++;\n          skipWhitespace();\n          var attrValue = '';\n          attr.valueType = 'string'; // @ts-ignore\n\n          if (chr === '\"') {\n            attrValue = getStr('\"', utils_1.doubleQuotesEscapeChars); // @ts-ignore\n          } else if (chr === '\\'') {\n            attrValue = getStr('\\'', utils_1.singleQuoteEscapeChars); // @ts-ignore\n          } else if (substitutesEnabled && chr === '$') {\n            pos++;\n            attrValue = getIdent();\n            attr.valueType = 'substitute';\n          } else {\n            while (pos < l) {\n              if (chr === ']') {\n                break;\n              }\n\n              attrValue += chr;\n              pos++;\n              chr = str.charAt(pos);\n            }\n\n            attrValue = attrValue.trim();\n          }\n\n          skipWhitespace();\n\n          if (pos >= l) {\n            throw Error('Expected \"]\" but end of file reached.');\n          }\n\n          if (chr !== ']') {\n            throw Error('Expected \"]\" but \"' + chr + '\" found.');\n          }\n\n          pos++;\n          attr.value = attrValue;\n        }\n\n        rule = rule || {};\n        (rule.attrs = rule.attrs || []).push(attr);\n      } else if (chr === ':') {\n        pos++;\n        var pseudoName = getIdent();\n        var pseudo = {\n          name: pseudoName\n        }; // @ts-ignore\n\n        if (chr === '(') {\n          pos++;\n          var value = '';\n          skipWhitespace();\n\n          if (pseudos[pseudoName] === 'selector') {\n            pseudo.valueType = 'selector';\n            value = parseSelector();\n          } else {\n            pseudo.valueType = pseudos[pseudoName] || 'string'; // @ts-ignore\n\n            if (chr === '\"') {\n              value = getStr('\"', utils_1.doubleQuotesEscapeChars); // @ts-ignore\n            } else if (chr === '\\'') {\n              value = getStr('\\'', utils_1.singleQuoteEscapeChars); // @ts-ignore\n            } else if (substitutesEnabled && chr === '$') {\n              pos++;\n              value = getIdent();\n              pseudo.valueType = 'substitute';\n            } else {\n              while (pos < l) {\n                if (chr === ')') {\n                  break;\n                }\n\n                value += chr;\n                pos++;\n                chr = str.charAt(pos);\n              }\n\n              value = value.trim();\n            }\n\n            skipWhitespace();\n          }\n\n          if (pos >= l) {\n            throw Error('Expected \")\" but end of file reached.');\n          }\n\n          if (chr !== ')') {\n            throw Error('Expected \")\" but \"' + chr + '\" found.');\n          }\n\n          pos++;\n          pseudo.value = value;\n        }\n\n        rule = rule || {};\n        (rule.pseudos = rule.pseudos || []).push(pseudo);\n      } else {\n        break;\n      }\n    }\n\n    return rule;\n  }\n\n  return parse();\n}\n\nexports.parseCssSelector = parseCssSelector;","map":{"version":3,"sources":["/Users/henryz2000/Downloads/chrome-react-seo-extension/node_modules/css-selector-parser/lib/parser-context.js"],"names":["Object","defineProperty","exports","value","utils_1","require","parseCssSelector","str","pos","pseudos","attrEqualityMods","ruleNestingOperators","substitutesEnabled","l","length","chr","getStr","quote","escapeTable","result","charAt","esc","undefined","isHex","hex","String","fromCharCode","parseInt","getIdent","isIdent","Error","identSpecialChars","skipWhitespace","parse","res","parseSelector","selector","parseSingleSelector","type","selectors","push","rule","parseRule","currentRule","op","nestingOperator","tagName","isIdentStart","classNames","id","attr","name","operator","attrValue","valueType","doubleQuotesEscapeChars","singleQuoteEscapeChars","trim","attrs","pseudoName","pseudo"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nfunction parseCssSelector(str, pos, pseudos, attrEqualityMods, ruleNestingOperators, substitutesEnabled) {\n    var l = str.length;\n    var chr = '';\n    function getStr(quote, escapeTable) {\n        var result = '';\n        pos++;\n        chr = str.charAt(pos);\n        while (pos < l) {\n            if (chr === quote) {\n                pos++;\n                return result;\n            }\n            else if (chr === '\\\\') {\n                pos++;\n                chr = str.charAt(pos);\n                var esc = void 0;\n                if (chr === quote) {\n                    result += quote;\n                }\n                else if ((esc = escapeTable[chr]) !== undefined) {\n                    result += esc;\n                }\n                else if (utils_1.isHex(chr)) {\n                    var hex = chr;\n                    pos++;\n                    chr = str.charAt(pos);\n                    while (utils_1.isHex(chr)) {\n                        hex += chr;\n                        pos++;\n                        chr = str.charAt(pos);\n                    }\n                    if (chr === ' ') {\n                        pos++;\n                        chr = str.charAt(pos);\n                    }\n                    result += String.fromCharCode(parseInt(hex, 16));\n                    continue;\n                }\n                else {\n                    result += chr;\n                }\n            }\n            else {\n                result += chr;\n            }\n            pos++;\n            chr = str.charAt(pos);\n        }\n        return result;\n    }\n    function getIdent() {\n        var result = '';\n        chr = str.charAt(pos);\n        while (pos < l) {\n            if (utils_1.isIdent(chr)) {\n                result += chr;\n            }\n            else if (chr === '\\\\') {\n                pos++;\n                if (pos >= l) {\n                    throw Error('Expected symbol but end of file reached.');\n                }\n                chr = str.charAt(pos);\n                if (utils_1.identSpecialChars[chr]) {\n                    result += chr;\n                }\n                else if (utils_1.isHex(chr)) {\n                    var hex = chr;\n                    pos++;\n                    chr = str.charAt(pos);\n                    while (utils_1.isHex(chr)) {\n                        hex += chr;\n                        pos++;\n                        chr = str.charAt(pos);\n                    }\n                    if (chr === ' ') {\n                        pos++;\n                        chr = str.charAt(pos);\n                    }\n                    result += String.fromCharCode(parseInt(hex, 16));\n                    continue;\n                }\n                else {\n                    result += chr;\n                }\n            }\n            else {\n                return result;\n            }\n            pos++;\n            chr = str.charAt(pos);\n        }\n        return result;\n    }\n    function skipWhitespace() {\n        chr = str.charAt(pos);\n        var result = false;\n        while (chr === ' ' || chr === \"\\t\" || chr === \"\\n\" || chr === \"\\r\" || chr === \"\\f\") {\n            result = true;\n            pos++;\n            chr = str.charAt(pos);\n        }\n        return result;\n    }\n    function parse() {\n        var res = parseSelector();\n        if (pos < l) {\n            throw Error('Rule expected but \"' + str.charAt(pos) + '\" found.');\n        }\n        return res;\n    }\n    function parseSelector() {\n        var selector = parseSingleSelector();\n        if (!selector) {\n            return null;\n        }\n        var res = selector;\n        chr = str.charAt(pos);\n        while (chr === ',') {\n            pos++;\n            skipWhitespace();\n            if (res.type !== 'selectors') {\n                res = {\n                    type: 'selectors',\n                    selectors: [selector]\n                };\n            }\n            selector = parseSingleSelector();\n            if (!selector) {\n                throw Error('Rule expected after \",\".');\n            }\n            res.selectors.push(selector);\n        }\n        return res;\n    }\n    function parseSingleSelector() {\n        skipWhitespace();\n        var selector = {\n            type: 'ruleSet'\n        };\n        var rule = parseRule();\n        if (!rule) {\n            return null;\n        }\n        var currentRule = selector;\n        while (rule) {\n            rule.type = 'rule';\n            currentRule.rule = rule;\n            currentRule = rule;\n            skipWhitespace();\n            chr = str.charAt(pos);\n            if (pos >= l || chr === ',' || chr === ')') {\n                break;\n            }\n            if (ruleNestingOperators[chr]) {\n                var op = chr;\n                pos++;\n                skipWhitespace();\n                rule = parseRule();\n                if (!rule) {\n                    throw Error('Rule expected after \"' + op + '\".');\n                }\n                rule.nestingOperator = op;\n            }\n            else {\n                rule = parseRule();\n                if (rule) {\n                    rule.nestingOperator = null;\n                }\n            }\n        }\n        return selector;\n    }\n    // @ts-ignore no-overlap\n    function parseRule() {\n        var rule = null;\n        while (pos < l) {\n            chr = str.charAt(pos);\n            if (chr === '*') {\n                pos++;\n                (rule = rule || {}).tagName = '*';\n            }\n            else if (utils_1.isIdentStart(chr) || chr === '\\\\') {\n                (rule = rule || {}).tagName = getIdent();\n            }\n            else if (chr === '.') {\n                pos++;\n                rule = rule || {};\n                (rule.classNames = rule.classNames || []).push(getIdent());\n            }\n            else if (chr === '#') {\n                pos++;\n                (rule = rule || {}).id = getIdent();\n            }\n            else if (chr === '[') {\n                pos++;\n                skipWhitespace();\n                var attr = {\n                    name: getIdent()\n                };\n                skipWhitespace();\n                // @ts-ignore\n                if (chr === ']') {\n                    pos++;\n                }\n                else {\n                    var operator = '';\n                    if (attrEqualityMods[chr]) {\n                        operator = chr;\n                        pos++;\n                        chr = str.charAt(pos);\n                    }\n                    if (pos >= l) {\n                        throw Error('Expected \"=\" but end of file reached.');\n                    }\n                    if (chr !== '=') {\n                        throw Error('Expected \"=\" but \"' + chr + '\" found.');\n                    }\n                    attr.operator = operator + '=';\n                    pos++;\n                    skipWhitespace();\n                    var attrValue = '';\n                    attr.valueType = 'string';\n                    // @ts-ignore\n                    if (chr === '\"') {\n                        attrValue = getStr('\"', utils_1.doubleQuotesEscapeChars);\n                        // @ts-ignore\n                    }\n                    else if (chr === '\\'') {\n                        attrValue = getStr('\\'', utils_1.singleQuoteEscapeChars);\n                        // @ts-ignore\n                    }\n                    else if (substitutesEnabled && chr === '$') {\n                        pos++;\n                        attrValue = getIdent();\n                        attr.valueType = 'substitute';\n                    }\n                    else {\n                        while (pos < l) {\n                            if (chr === ']') {\n                                break;\n                            }\n                            attrValue += chr;\n                            pos++;\n                            chr = str.charAt(pos);\n                        }\n                        attrValue = attrValue.trim();\n                    }\n                    skipWhitespace();\n                    if (pos >= l) {\n                        throw Error('Expected \"]\" but end of file reached.');\n                    }\n                    if (chr !== ']') {\n                        throw Error('Expected \"]\" but \"' + chr + '\" found.');\n                    }\n                    pos++;\n                    attr.value = attrValue;\n                }\n                rule = rule || {};\n                (rule.attrs = rule.attrs || []).push(attr);\n            }\n            else if (chr === ':') {\n                pos++;\n                var pseudoName = getIdent();\n                var pseudo = {\n                    name: pseudoName\n                };\n                // @ts-ignore\n                if (chr === '(') {\n                    pos++;\n                    var value = '';\n                    skipWhitespace();\n                    if (pseudos[pseudoName] === 'selector') {\n                        pseudo.valueType = 'selector';\n                        value = parseSelector();\n                    }\n                    else {\n                        pseudo.valueType = pseudos[pseudoName] || 'string';\n                        // @ts-ignore\n                        if (chr === '\"') {\n                            value = getStr('\"', utils_1.doubleQuotesEscapeChars);\n                            // @ts-ignore\n                        }\n                        else if (chr === '\\'') {\n                            value = getStr('\\'', utils_1.singleQuoteEscapeChars);\n                            // @ts-ignore\n                        }\n                        else if (substitutesEnabled && chr === '$') {\n                            pos++;\n                            value = getIdent();\n                            pseudo.valueType = 'substitute';\n                        }\n                        else {\n                            while (pos < l) {\n                                if (chr === ')') {\n                                    break;\n                                }\n                                value += chr;\n                                pos++;\n                                chr = str.charAt(pos);\n                            }\n                            value = value.trim();\n                        }\n                        skipWhitespace();\n                    }\n                    if (pos >= l) {\n                        throw Error('Expected \")\" but end of file reached.');\n                    }\n                    if (chr !== ')') {\n                        throw Error('Expected \")\" but \"' + chr + '\" found.');\n                    }\n                    pos++;\n                    pseudo.value = value;\n                }\n                rule = rule || {};\n                (rule.pseudos = rule.pseudos || []).push(pseudo);\n            }\n            else {\n                break;\n            }\n        }\n        return rule;\n    }\n    return parse();\n}\nexports.parseCssSelector = parseCssSelector;\n"]},"metadata":{},"sourceType":"script"}